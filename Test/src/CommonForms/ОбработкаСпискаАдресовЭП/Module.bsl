#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	НельзяВыбиратьТипПолучателей = Неопределено;
	Параметры.Свойство("НельзяВыбиратьТипПолучателей", НельзяВыбиратьТипПолучателей);
	Если НельзяВыбиратьТипПолучателей = Истина Тогда
		Элементы.ТипПолучателя.Видимость = Ложь;
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	Если Элементы.ТипПолучателя.Видимость Тогда
		ТипПолучателя = Элементы.ТипПолучателя.СписокВыбора[0].Значение;
	Иначе
		ТипПолучателя = ПредопределенноеЗначение("Перечисление.ТипыПолучателейЭлектронногоПисьма.Кому");
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура ЗакрытьКнопка(Команда)
	
	Закрыть();
	
КонецПроцедуры

&НаКлиенте
Процедура ДобавитьСписок(Команда)
	
	Адресаты = СтрЗаменить(СтрокаДляОбработки, ",", ";");
	Адресаты = СтрЗаменить(Адресаты, Символы.ПС, ";");
	Адресаты = ОбщегоНазначенияКлиентСервер.АдресаЭлектроннойПочтыИзСтроки(Адресаты);
	
	АдресВХранилище = АдресПолучателейИзСтроки(Адресаты);
	Закрыть(АдресВХранилище);
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Функция АдресПолучателейИзСтроки(Адресаты)
	
	АдресВХранилище = ЭлектроннаяПочтаУНФ.АдресАдресатовВоВременномХранилище(Адресаты, ТипПолучателя);
	Возврат АдресВХранилище;
	
КонецФункции

#КонецОбласти


