#Область ОбработчикиСобытий

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	ДанныеЗаполнения = ДанныеЗаполненияВедомостиПоОтпуску(ПараметрКоманды);
	Если ЗначениеЗаполнено(ДанныеЗаполнения.СообщениеПользователю) Тогда
		ПоказатьПредупреждение( , ДанныеЗаполнения.СообщениеПользователю);
		Возврат;
	КонецЕсли;
	
	ДанныеЗаполнения.Вставить("Действие", "ЗаполнитьПоПараметрамЗаполнения");
	
	ПараметрыФормы = Новый Структура("ЗначенияЗаполнения", ДанныеЗаполнения);
	ОткрытьФорму("Документ.ВедомостьНаВыплатуЗарплатыВКассу.ФормаОбъекта", ПараметрыФормы,
		ПараметрыВыполненияКоманды.Источник, ПараметрыВыполненияКоманды.Уникальность,
		ПараметрыВыполненияКоманды.Окно, ПараметрыВыполненияКоманды.НавигационнаяСсылка);
	
КонецПроцедуры

#КонецОбласти


#Область СлужебныеПроцедурыИФункции

&НаСервере
Функция ДанныеЗаполненияВедомостиПоОтпуску(Отпуск)
	
	ДанныеЗаполнения = Обработки.ПомощникВыплатыЗарплаты.ДанныеЗаполненияВедомостиПоДокументу(Отпуск,
		Метаданные.Документы.ВедомостьНаВыплатуЗарплатыВКассу);
	
	Возврат ДанныеЗаполнения;
КонецФункции

#КонецОбласти